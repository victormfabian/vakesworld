# Supabase Admin Setup

Follow these steps to enable the admin portal in the same Vite app.

## 1) Create the Supabase project
- Create a new project in Supabase.
- Copy the Project URL and anon key.

## 2) Add environment variables
Create a `.env` file in the project root with:

```
VITE_SUPABASE_URL=your-project-url
VITE_SUPABASE_ANON_KEY=your-anon-key
```

You can also copy `.env.example` and fill in the values.

## 3) Create the tables and policies
Run this SQL in Supabase (SQL Editor):

```
create table if not exists public.site_content (
  id bigint primary key,
  hero_eyebrow text not null,
  hero_tagline text not null,
  hero_subline text not null,
  logo_url text not null,
  instagram_url text not null,
  tiktok_url text not null,
  youtube_url text not null,
  footer_text text not null,
  updated_at timestamptz default now()
);

-- If you already created the table, add the new columns:
alter table public.site_content
  add column if not exists instagram_url text not null default 'https://www.instagram.com/vakesworld',
  add column if not exists tiktok_url text not null default 'https://www.tiktok.com/@vakesworld',
  add column if not exists youtube_url text not null default 'https://www.youtube.com/@vakesworld';

create table if not exists public.portals (
  id bigint generated by default as identity primary key,
  meta text not null,
  title text not null,
  href text not null,
  sort_order integer not null default 1,
  services jsonb not null default '[]'::jsonb,
  success_kit jsonb not null default '{}'::jsonb,
  shop jsonb not null default '{}'::jsonb,
  work_form jsonb not null default '{}'::jsonb,
  updated_at timestamptz default now()
);

-- If you already created the table, add the new column:
alter table public.portals
  add column if not exists services jsonb not null default '[]'::jsonb;
alter table public.portals
  add column if not exists success_kit jsonb not null default '{}'::jsonb;
alter table public.portals
  add column if not exists shop jsonb not null default '{}'::jsonb;
alter table public.portals
  add column if not exists work_form jsonb not null default '{}'::jsonb;

create table if not exists public.orders (
  id bigint generated by default as identity primary key,
  product_title text not null,
  product_category text not null,
  product_price text not null,
  product_image text not null default '',
  size text not null,
  customer_name text not null,
  customer_address text not null,
  customer_email text not null,
  customer_phone text not null,
  currency text not null default 'NGN',
  amount numeric not null default 0,
  status text not null default 'payment_pending',
  created_at timestamptz default now()
);

create table if not exists public.work_requests (
  id bigint generated by default as identity primary key,
  service text not null,
  name text not null,
  industry text not null,
  other text not null default '',
  email text not null,
  phone text not null,
  message text not null,
  agreement boolean not null default false,
  date text not null,
  time text not null,
  timezone text not null,
  meeting_mode text not null,
  status text not null default 'new',
  created_at timestamptz default now()
);

alter table public.site_content enable row level security;
alter table public.portals enable row level security;
alter table public.orders enable row level security;
alter table public.work_requests enable row level security;

create policy "site_content read" on public.site_content
  for select using (true);

create policy "site_content write" on public.site_content
  for all to authenticated using (auth.email() = 'victorvakes@gmail.com')
  with check (auth.email() = 'victorvakes@gmail.com');

create policy "portals read" on public.portals
  for select using (true);

create policy "portals write" on public.portals
  for all to authenticated using (auth.email() = 'victorvakes@gmail.com')
  with check (auth.email() = 'victorvakes@gmail.com');

create policy "orders insert" on public.orders
  for insert with check (true);

create policy "orders read" on public.orders
  for select to authenticated using (auth.email() = 'victorvakes@gmail.com');

create policy "orders write" on public.orders
  for update to authenticated using (auth.email() = 'victorvakes@gmail.com')
  with check (auth.email() = 'victorvakes@gmail.com');

create policy "work_requests insert" on public.work_requests
  for insert with check (true);

create policy "work_requests read" on public.work_requests
  for select to authenticated using (auth.email() = 'victorvakes@gmail.com');

create policy "work_requests write" on public.work_requests
  for update to authenticated using (auth.email() = 'victorvakes@gmail.com')
  with check (auth.email() = 'victorvakes@gmail.com');

-- If you already created the orders table, add the new columns:
alter table public.orders
  add column if not exists currency text not null default 'NGN';
alter table public.orders
  add column if not exists amount numeric not null default 0;
```

## 4) Seed default content
Run this SQL once:

```
insert into public.site_content (
  id,
  hero_eyebrow,
  hero_tagline,
  hero_subline,
  logo_url,
  instagram_url,
  tiktok_url,
  youtube_url,
  footer_text
) values (
  1,
  'Curated Creative Universe',
  'Pioneering Visions',
  'Art. Technology. Culture.',
  '/src/assets/vakes-logo.png',
  'https://www.instagram.com/vakesworld',
  'https://www.tiktok.com/@vakesworld',
  'https://www.youtube.com/@vakesworld',
  'Ac VAKES World'
) on conflict (id) do nothing;

insert into public.portals (meta, title, href, sort_order) values
  ('Services', 'Creative Systems', '#', 1),
  ('Products & Ideas', 'Apps & SaaS', '#', 2),
  ('Shop', 'Objects & Editions', '#', 3),
  ('Work With VAKES', 'Start a Project', '#', 4);

-- Optional: seed services for the Services card.
update public.portals
set services = '[
  {"title":"Branding","description":"Identity systems, strategy, and visual direction.","image":""},
  {"title":"Digital Art","description":"Illustration, motion, and immersive visuals.","image":""},
  {"title":"UI/UX Design","description":"Product interfaces, flows, and usability systems.","image":""},
  {"title":"Web & App Dev","description":"Full-stack builds, integrations, and launches.","image":""}
]'::jsonb
where meta = 'Services' and title = 'Creative Systems';

-- Optional: seed Success Kit content.
update public.portals
set success_kit = '{
  "assets": [
    {"title":"Brand Kit Templates","tags":"templates, identity, brand","link":""},
    {"title":"Social Media Pack","tags":"content, social, layouts","link":""}
  ],
  "tools": [
    {"title":"Creator Stack","tags":"apps, workflow, publishing","link":""},
    {"title":"Productivity System","tags":"planning, checklists, ops","link":""}
  ],
  "courses": [
    {"title":"Brand Strategy Basics","tags":"positioning, messaging","link":""},
    {"title":"UI/UX Launchpad","tags":"ui/ux, product","link":""}
  ]
}'::jsonb
where lower(meta) = 'success kit' or lower(title) = 'success kit';

-- Optional: seed Shop content.
update public.portals
set shop = '{
  "enabled": true,
  "currency": "NGN",
  "currency_rates": {"USD":1500,"GBP":1900,"EUR":1700},
  "items": [
    {"title":"Gallery Print","price_ngn":120000,"image":"","images":[],"description":"","sizes":["S","M","L"],"category":"art"},
    {"title":"Studio Hoodie","price_ngn":85000,"image":"","images":[],"description":"","sizes":["S","M","L","XL"],"category":"clothing"},
    {"title":"Canvas Tote","price_ngn":38000,"image":"","images":[],"description":"","sizes":["One Size"],"category":"accessories"}
  ]
}'::jsonb
where lower(meta) = 'shop' or lower(title) = 'shop';

-- Optional: seed Work With Me form options.
update public.portals
set work_form = '{
  "services": ["Branding", "Digital Art", "UI/UX Design", "Web & App Dev"],
  "industries": ["Creative", "Tech", "Retail", "Hospitality", "Other"],
  "meeting_modes": ["Google Meet", "Zoom", "WhatsApp"],
  "timezones": ["Africa/Lagos", "Europe/London", "America/New_York", "UTC"],
  "agreement_label": "I agree to be contacted about this request."
}'::jsonb
where lower(meta) = 'work with vakes' or lower(title) = 'start a project';
```

## 5) Create your admin user
- Go to Supabase Auth and create an email/password user.
- Or use the Admin Portal "Create admin account" button in the app.

## 6) Open the Admin Portal
Visit:

```
/#/admin
```

Log in with your email/password and update content.
